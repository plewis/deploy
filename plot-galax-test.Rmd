---
title: "RGL Perspective Plots"
author: "Paul Lewis"
date: "2024-07-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

Plot of simulated combinations of theta and lambda

```{r}
halftheta = c(0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.03,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.07,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.11,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.13,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15)
T = c(0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3,0.01,0.0307143,0.0514286,0.0721429,0.0928571,0.113571,0.134286,0.155,0.175714,0.196429,0.217143,0.237857,0.258571,0.279286,0.3)
numdeep = c(207,97,26,13,43,28,3,6,18,15,6,4,20,3,6,101,165,61,87,50,42,21,23,72,18,22,28,16,8,0,242,107,118,40,120,8,68,12,46,40,36,25,3,50,40,244,103,80,187,105,69,22,35,26,51,35,24,78,39,52,203,188,103,108,121,90,78,59,73,41,25,39,43,18,40,157,241,175,87,62,107,67,96,66,91,100,39,43,65,122,171,155,209,179,96,88,105,127,48,46,16,85,57,43,46,223,209,88,138,109,75,187,125,169,110,43,74,53,126,33,131,156,136,109,105,79,102,150,182,56,108,47,68,67,83,315,175,200,235,112,70,134,53,68,101,68,64,154,46,231,185,189,229,93,127,127,78,147,148,75,39,86,43,104,96,393,157,246,133,89,174,81,88,145,75,81,57,43,66,78,277,232,241,184,239,94,132,201,152,113,178,84,81,121,139,208,280,157,121,124,112,126,117,63,109,169,151,97,75,94,250,151,149,286,146,118,95,165,129,100,155,125,139,180,137)
maxdeep = c(456,240,300,220,432,320,240,260,440,312,312,336,380,408,340,260,408,300,408,280,432,280,320,480,300,340,286,360,240,380,360,200,288,240,330,220,336,280,384,360,320,220,300,336,380,400,220,264,432,380,352,308,400,400,380,360,300,330,360,308,312,340,264,288,400,396,308,396,240,360,260,288,220,380,320,242,418,400,200,312,380,264,400,360,242,380,240,264,360,480,240,360,374,440,260,300,240,352,280,280,280,456,200,300,280,336,336,200,418,260,286,432,300,336,396,240,220,320,240,260,200,220,240,264,220,264,288,340,480,200,408,220,280,264,312,432,240,432,440,280,280,352,240,380,336,312,220,400,264,400,260,360,432,200,300,380,300,360,312,280,240,408,240,240,312,480,264,396,300,264,360,264,264,312,288,240,280,220,480,380,360,360,418,374,480,220,374,360,384,352,340,288,220,456,312,280,408,240,360,264,242,330,240,288,408,360,360,360,220,360,340,240,288,432,240,220,260,300,336,340,320,220,360,374,408)
nspecies = 5
smcmean   <- c(2,2,1.712,0,0,0,0,0,0,0,0,0,0,0,0,0,3.96,2,0,2,1.4,0,0,0,0,0,0,2,0,0,1.966,0,0,0,0,0,4,0,0,2,0,0,0,4,1.966,0,0,0,2,0,0,0,0,2,0,0,2,2,0,0,2.008,2,2.32,0,1.998,1.954,2,0,2,0,0,2,0,0,0,0,2,0,2,2,0,2,2,0,1.46,0,0,2,0,0.144,2.514,2,0,0,0,0,2,2,0,0,1.822,2,0,0,0.092,2,3.814,0,4,2,1.378,1.852,3.562,4,2,0,2,0,4,0,0.022,3.722,0,1.99,0,1.17,0,2,2,0,1.998,0,1.714,2,0.032,4,4,2,4,1.726,0,0,0,0,0,2,0,0,1.748,0.022,1.214,0.11,4,2,4,2,2,2,2,0,1.008,2,0,0,0,3.944,0,4,0.246,0,2,2,2,4,2,2,0,0,0,0,4,1.198,2.8,3.318,2,2,0,1.972,2,2,0.094,0,1.998,2,3.646,4,2,3.996,0,0.084,2.05,4,2,3.99,0,2,1.998,2,0,4,1.956,1.84,2,4,1.968,2,2,4,4,2,2,0.854,0,2,1.56)

plot(halftheta, T, type="p", pch=19, main="Simulation conditions", xlab="theta/2", ylab="T")
```
Set colors for plots

```{r}
bgcolor <- "cornsilk"
planecolor <- "ghostwhite"
surfcolor <- "red"
```

Set up values used for the x-axis and y-axis of the grid

```{r}
halftheta_vals <- unique(halftheta)
cat("halftheta_vals:\n")
halftheta_vals
ncols <- length(halftheta_vals)

T_vals <- unique(T)
cat("T_vals:\n")
T_vals
nrows <- length(T_vals)
```

Plot new info content.

```{r}
info <- c(100,96.7328,89.7746,100,100,100,100,100,100,100,100,100,100,100,84.3427,100,97.339,100,100,100,84.1653,100,100,100,99.7911,100,100,100,100,100,98.2224,99.5899,100,100,100,100,100,100,100,100,100,100,100,100,97.7523,99.327,100,94.4228,100,100,100,99.0138,100,100,100,100,100,100,100,99.4299,99.6225,100,85.4812,89.7072,99.8855,82.0238,100,85.118,95.8285,100,100,90.5111,100,100,100,85.0348,99.1876,100,96.5248,100,100,100,100,96.4168,84.2918,100,84.3446,100,100,95.5511,71.2014,100,100,100,100,100,100,99.8855,100,100,91.0904,100,100,85.6162,97.0152,95.4789,90.8147,100,100,100,84.1124,92.5893,69.9276,99.3255,100,89.6332,94.3759,100,99.8855,100,91.0849,88.3542,100,93.9349,100,84.3058,100,100,95.5511,100,99.7711,100,88.5261,98.7583,98.7007,98.4001,100,86.4915,100,89.0613,97.994,100,99.3356,89.465,100,100,100,100,93.0305,99.1235,63.0349,96.4035,100,99.8855,100,100,100,100,100,100,83.7525,100,100,100,100,84.252,100,100,93.5014,100,100,96.784,100,100,94.7176,100,100,100,100,100,100,63.1323,86.2644,84.101,100,99.8855,100,97.1938,100,99.7911,96.784,100,99.6767,100,87.4152,100,99.5899,98.4453,100,97.2035,89.288,100,100,99.2489,100,100,99.8855,100,94.5756,85.0546,96.9993,87.6995,100,100,87.1308,100,96.365,93.4847,99.6225,100,100,83.0125,100,99.5824,85.5498)
infodf <- data.frame(halftheta, T, info, smcmean)
proportiondeep <- numdeep/maxdeep
```

Plot old info content.

```{r}
old_info <- c(100,95.1506,84.8228,100,100,100,100,100,100,100,100,100,100,100,76.7603,100,96.0504,100,100,100,76.4969,100,100,100,99.69,100,100,100,100,100,97.3616,99.3913,100,100,100,100,100,100,100,100,100,100,100,100,96.6637,99.0011,100,91.7219,100,100,100,98.5362,100,100,100,100,100,100,100,99.1538,99.4397,100,78.4501,84.7227,99.8301,73.3184,100,77.911,93.8084,100,100,85.9159,100,100,100,77.7875,98.7941,100,94.8418,100,100,100,100,94.6815,76.6848,100,76.7631,100,100,93.3966,57.255,100,100,100,100,100,100,99.8301,100,100,86.7757,100,100,78.6506,95.5697,93.2894,86.3665,100,100,100,76.4185,89.0004,55.3644,98.9988,100,84.6128,91.6522,100,99.8301,100,86.7675,82.7145,100,90.9977,100,76.7055,100,100,93.3966,100,99.6602,100,82.9695,98.1569,98.0714,97.6253,100,79.9496,100,83.7639,97.0225,100,99.0138,84.3631,100,100,100,100,89.6553,98.699,45.1336,94.6619,100,99.8301,100,100,100,100,100,100,75.8842,100,100,100,100,76.6257,100,100,90.3543,100,100,95.2266,100,100,92.1594,100,100,100,100,100,100,45.2781,79.6125,76.4016,100,99.8301,100,95.8349,100,99.69,95.2266,100,99.5201,100,81.3207,100,99.3913,97.6924,100,95.8493,84.1005,100,100,98.8851,100,100,99.8301,100,91.9486,77.817,95.5461,81.7426,100,100,80.8986,100,94.6047,90.3294,99.4397,100,100,74.7859,100,99.3801,78.5519)
old_infodf <- data.frame(halftheta, T, old_info, smcmean)
```

Contour plot new info

```{r}
v <- ggplot(infodf, aes(halftheta, T, z = info))
v + geom_contour_filled(breaks=c(63.035,67.142,71.249,75.357,79.464,83.571,87.678,91.786,95.893)) + labs(x=expression(theta/2))
```

Contour plot old info

```{r}
v <- ggplot(old_infodf, aes(halftheta, T, z = old_info))
v + geom_contour_filled(breaks=c(63.035,67.142,71.249,75.357,79.464,83.571,87.678,91.786,95.893)) + labs(x=expression(theta/2))
```

Contour plot showing number of deep coalescences

```{r}
v <- ggplot(infodf, aes(halftheta, T, z = proportiondeep))
v + geom_contour_filled(breaks=c(0.0,0.2,0.4,0.6,0.8,1.0)) + labs(x=expression(theta/2))
```

# PLot RF distance vs info with points colored by ngenes
```{r}
ngenes   <- c(19,12,15,10,18,16,12,13,20,13,13,14,19,17,17,13,17,15,17,14,18,14,16,20,15,17,13,18,10,19,15,10,12,12,15,11,14,14,16,15,16,11,15,14,19,20,10,11,18,19,16,14,20,20,19,18,15,15,18,14,13,17,11,12,20,18,14,18,10,18,13,12,11,19,16,11,19,20,10,13,19,12,20,15,11,19,12,11,15,20,10,15,17,20,13,15,12,16,14,14,14,19,10,15,14,14,14,10,19,13,13,18,15,14,18,12,11,16,12,13,10,11,12,12,11,12,12,17,20,10,17,11,14,11,13,18,12,18,20,14,14,16,10,19,14,13,11,20,11,20,13,18,18,10,15,19,15,15,13,14,10,17,12,12,13,20,12,18,15,12,15,11,12,13,12,12,14,11,20,19,15,18,19,17,20,11,17,15,16,16,17,12,10,19,13,14,17,12,18,12,11,15,12,12,17,18,15,15,10,18,17,10,12,18,10,10,13,15,14,17,16,11,18,17,17)

v <- ggplot(infodf, aes(info, smcmean, z = ngenes, color = ngenes)) + geom_jitter() +
  scale_color_gradient(low="blue", high="green")
v
```

# PLot RF distance vs info with points colored by theta/2
```{r}
v <- ggplot(infodf, aes(info, smcmean, z = halftheta, color = halftheta)) + geom_jitter() +
  scale_color_gradient(low="blue", high="green")
v
```

# PLot RF distance vs info with points colored by T
```{r}
v <- ggplot(infodf, aes(info, smcmean, z = T, color = T)) + geom_jitter() +
  scale_color_gradient(low="blue", high="green")
v
```

# PLot RF distance vs info with points colored by average sequence length
```{r}
avgseqlen   <- c(396.947,374.25,584.133,453.3,482.389,505.625,390.083,537.385,541.9,590.923,435.077,615.357,604.105,504.882,490.294,541.769,606.529,386.133,566.353,413.143,383.056,458.5,551,470.1,360.867,498.588,572.846,492.056,554.2,544.316,437,561.9,405.917,576.917,615.733,300,496.143,446.429,486.312,647.067,549.875,482.545,633.4,427.286,536.947,467.25,596.9,495.545,594.944,379.158,375.812,504.786,525.8,499.95,435.526,509.444,483.133,551.4,518.056,403.071,492.923,465.471,457.455,538.75,582.8,444.667,374.286,612.167,569.7,452.444,434.077,564.333,560.455,493.421,476.5,478.091,557.895,609.2,626.8,408.077,437.368,595.667,462.15,503.733,727.364,418.947,676.75,423.636,497.4,476.65,333.3,605.667,422.765,601.25,646,419.2,498.25,533.062,397.5,404.714,469.643,543.263,630.5,472.533,611.5,415.071,530.071,574.9,508,692,554,584.222,490.533,509.929,616.444,658.667,465.909,270,499.75,508.077,449.8,428.455,431.667,474.083,580,464.417,617.5,470.294,520.8,640.7,442.353,446,511,608.818,445.462,548.056,474.917,419.556,447.1,476,557.214,434.5,488.5,480.263,495.429,646.462,603.364,447.65,471.545,427.25,589.077,399.667,524.889,418.6,527.6,569.579,505.733,498.4,494.846,478.286,471.1,558.824,551.167,437.917,511.769,505.6,526.583,496.833,461.133,521.583,537.8,535.455,442.417,563.923,532.583,463.083,572.714,567.636,464.75,428.632,509.533,496.889,493.421,620.647,626.95,660,421.235,529.933,498.062,504.938,491.588,389.083,408.1,407.842,496.923,415.857,488.647,565.417,460.167,389.583,515.727,419.333,502.833,607.167,584.941,534.611,490.867,516.733,514.2,450.333,508.824,416.8,461.167,575.333,366.8,360,420.923,476.4,540,531.412,488.375,442.636,562.889,616.118,517.412)

v <- ggplot(infodf, aes(info, smcmean, z = T, color = avgseqlen)) + geom_jitter() +
  scale_color_gradient(low="blue", high="green")
v
```